<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Captcha Finder</title>
  <style>
    /* === LIGHT MODE (DEFAULT) === */
    :root {
      --primary: #4a6fa5;
      --secondary: #6c757d;
      --success: #28a745;
      --danger: #dc3545;
      --light: #f8f9fa;
      --dark: #343a40;
      --bg: #f5f7fa;
      --card-bg: white;
      --text: #2d3748;
      --border: #e2e8f0;
      --header-bg: rgba(255, 255, 255, 0.95);
      --footer-bg: #343a40;
      --footer-text: #ccc;
      --scrollbar-track: #f1f1f1;
      --scrollbar-thumb: #4a6fa5;
      --scrollbar-thumb-hover: #3a5a8a;
    }
    /* === DARK MODE === */
    [data-theme="dark"] {
      --primary: #6c9eff;
      --secondary: #a0aec0;
      --success: #48bb78;
      --danger: #f56565;
      --light: #2d3748;
      --dark: #f7fafc;
      --bg: #0f172a;
      --card-bg: #1e293b;
      --text: #e2e8f0;
      --border: #334155;
      --header-bg: rgba(15, 23, 42, 0.95);
      --footer-bg: #0a0e1a;
      --footer-text: #94a3b8;
      --scrollbar-track: #1e293b;
      --scrollbar-thumb: #6c9eff;
      --scrollbar-thumb-hover: #5b8cff;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      transition: background 0.3s ease, color 0.3s ease, border-color 0.3s ease;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--bg) 0%, color-mix(in srgb, var(--bg), black 20%) 100%);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      background: var(--header-bg);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      padding: 1rem 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .logo {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .logo i {
      font-size: 2rem;
    }
    nav ul {
      display: flex;
      list-style: none;
      gap: 2rem;
      align-items: center;
    }
    nav a {
      text-decoration: none;
      color: var(--text);
      font-weight: 500;
      transition: color 0.3s;
      position: relative;
    }
    nav a:hover {
      color: var(--primary);
    }
    nav a::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -5px;
      left: 0;
      background-color: var(--primary);
      transition: width 0.3s;
    }
    nav a:hover::after {
      width: 100%;
    }
    /* === USER MENU (LOGIN / REGISTER / LOGOUT) === */
    .user-menu {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-weight: 500;
    }
    .user-menu a, .user-menu button {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1rem;
      cursor: pointer;
      text-decoration: none;
    }
    .user-menu .username {
      color: var(--primary);
      font-weight: 600;
    }
    .user-menu .logout {
      color: var(--danger);
    }
    .user-menu .logout:hover {
      text-decoration: underline;
    }
    /* === SMALLER TOGGLE BUTTON === */
    .theme-toggle {
      background: var(--card-bg);
      border: 2px solid var(--border);
      border-radius: 50px;
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 1rem;
      color: var(--text);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }
    .theme-toggle:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      border-color: var(--primary);
    }
    main {
      flex: 1;
      padding: 3rem 0;
    }
    .hero {
      text-align: center;
      padding: 4rem 0;
      background: var(--card-bg);
      border-radius: 12px;
      margin-bottom: 3rem;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    }
    .hero h1 {
      font-size: 3rem;
      margin-bottom: 1rem;
      background: linear-gradient(90deg, var(--primary), color-mix(in srgb, var(--primary), white 30%));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .hero p {
      font-size: 1.2rem;
      color: var(--secondary);
      max-width: 700px;
      margin: 0 auto 2rem;
    }
    .search-section {
      background: var(--card-bg);
      padding: 2.5rem;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 3rem;
    }
    .search-box {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    .input-group {
      flex: 1;
      min-width: 300px;
      position: relative;
    }
    .input-group input {
      width: 100%;
      padding: 1rem 1rem 1rem 3rem;
      border: 2px solid var(--border);
      border-radius: 12px;
      font-size: 1rem;
      background: var(--card-bg);
      color: var(--text);
      transition: all 0.3s;
    }
    .input-group input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary), transparent 80%);
    }
    .input-group i {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--secondary);
    }
    .btn {
      padding: 1rem 2rem;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      text-decoration: none;
    }
    .btn-primary {
      background: var(--primary);
      color: white;
    }
    .btn-primary:hover {
      background: color-mix(in srgb, var(--primary), black 20%);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px color-mix(in srgb, var(--primary), transparent 70%);
    }
    .btn-outline {
      background: transparent;
      color: var(--primary);
      border: 2px solid var(--primary);
    }
    .btn-outline:hover {
      background: var(--primary);
      color: white;
    }
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin: 3rem 0;
    }
    .feature-card {
      background: var(--card-bg);
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s;
      text-align: center;
    }
    .feature-card:hover {
      transform: translateY(-10px);
    }
    .feature-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      color: var(--primary);
    }
    .feature-card h3 {
      margin-bottom: 1rem;
      color: var(--text);
    }
    .feature-card p {
      color: var(--secondary);
    }
    .results {
      background: var(--card-bg);
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      margin-top: 2rem;
      display: none;
    }
    .result-item {
      padding: 1rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .result-item:last-child {
      border-bottom: none;
    }
    .result-type {
      background: color-mix(in srgb, var(--primary), transparent 90%);
      color: var(--primary);
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }
    .no-results {
      text-align: center;
      padding: 3rem;
      color: var(--secondary);
    }
    .loading {
      text-align: center;
      padding: 2rem;
    }
    .spinner {
      border: 4px solid var(--border);
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    footer {
      background: var(--footer-bg);
      color: var(--footer-text);
      padding: 3rem 0 1rem;
      margin-top: 3rem;
    }
    .footer-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      margin-bottom: 2rem;
    }
    .footer-section h3 {
      margin-bottom: 1rem;
      color: white;
    }
    .footer-section ul {
      list-style: none;
    }
    .footer-section ul li {
      margin-bottom: 0.5rem;
    }
    .footer-section a {
      color: var(--footer-text);
      text-decoration: none;
      transition: color 0.3s;
    }
    .footer-section a:hover {
      color: white;
    }
    .footer-bottom {
      text-align: center;
      padding-top: 2rem;
      border-top: 1px solid color-mix(in srgb, white, transparent 90%);
      color: #94a3b8;
      font-size: 0.9rem;
    }
    @media (max-width: 768px) {
      .header-content {
        flex-direction: column;
        gap: 1rem;
      }
      nav ul {
        gap: 1rem;
      }
      .hero h1 {
        font-size: 2.2rem;
      }
      .search-box {
        flex-direction: column;
      }
      .input-group {
        min-width: 100%;
      }
      .theme-toggle {
        margin: 0 auto;
      }
    }
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: var(--scrollbar-track);
    }
    ::-webkit-scrollbar-thumb {
      background: var(--scrollbar-thumb);
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: var(--scrollbar-thumb-hover);
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <header>
    <div class="container">
      <div class="header-content">
        <a href="/" class="logo">
          <i class="fas fa-shield-alt"></i>
          Captcha Finder
        </a>
        <nav>
          <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#features">Features</a></li>
            <li><a href="#how-it-works">How It Works</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
        </nav>
        <div style="display: flex; align-items: center; gap: 1rem;">
          <!-- User Menu -->
          <div class="user-menu" id="userMenu">
            <a href="/login.html">Login</a>
            <a href="/register.html">Register</a>
          </div>
          <!-- Theme Toggle -->
          <div class="theme-toggle" id="themeToggle">
            <i class="fas fa-moon"></i>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="hero" id="home">
        <h1>CapTcha Tool</h1>
        <p>Quickly detect and analyze CAPTCHA implementations across websites. Perfect for developers, security researchers, and QA testers.</p>
        <div class="search-box">
          <div class="input-group">
            <i class="fas fa-globe"></i>
            <input type="url" id="urlInput" placeholder="Enter website URL (e.g., https://example.com)" required>
          </div>
          <button class="btn btn-primary" id="scanBtn">
            <i class="fas fa-search"></i>
            Scan for CAPTCHAs
          </button>
        </div>
      </section>

      <section class="search-section">
        <h2 style="margin-bottom: 1.5rem; text-align: center;">Advanced Scanning Options</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; color: var(--text);">
            <input type="checkbox" id="scanImages" checked>
            <span>Scan for image CAPTCHAs</span>
          </label>
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; color: var(--text);">
            <input type="checkbox" id="scanRecaptcha" checked>
            <span>Detect Google reCAPTCHA</span>
          </label>
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; color: var(--text);">
            <input type="checkbox" id="scanHcaptcha" checked>
            <span>Detect hCaptcha</span>
          </label>
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; color: var(--text);">
            <input type="checkbox" id="scanCustom" checked>
            <span>Find custom CAPTCHA scripts</span>
          </label>
        </div>
        <div style="text-align: center;">
          <button class="btn btn-outline" id="clearBtn">
            <i class="fas fa-trash"></i>
            Clear Results
          </button>
        </div>
      </section>

      <section class="results" id="results">
        <h2 style="margin-bottom: 1.5rem;">Scan Results</h2>
        <div id="resultsContainer"></div>
      </section>

      <section class="features" id="features">
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-bolt"></i></div>
          <h3>Lightning Fast</h3>
          <p>Scan any website in seconds with our optimized detection algorithms.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
          <h3>Multiple Types</h3>
          <p>Detect reCAPTCHA, hCaptcha, image-based, text-based, and custom implementations.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-code"></i></div>
          <h3>Developer Friendly</h3>
          <p>Get detailed information about CAPTCHA scripts, attributes, and implementation.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-chart-bar"></i></div>
          <h3>Detailed Reports</h3>
          <p>Export results in JSON or CSV format for further analysis.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-lock"></i></div>
          <h3>Privacy First</h3>
          <p>All scans are performed server-side securely. Your data is encrypted.</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-mobile-alt"></i></div>
          <h3>Fully Responsive</h3>
          <p>Works perfectly on desktop, tablet, and mobile devices.</p>
        </div>
      </section>
    </div>
  </main>

  <footer id="contact">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Captcha Finder</h3>
          <p>Advanced CAPTCHA detection tool for developers and security researchers.</p>
        </div>
        <div class="footer-section">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="#home">Home</a></li>
            <li><a href="#features">Features</a></li>
            <li><a href="#how-it-works">How It Works</a></li>
            <li><a href="#">Documentation</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Supported CAPTCHAs</h3>
          <ul>
            <li>Google reCAPTCHA v2/v3</li>
            <li>hCaptcha</li>
            <li>Image-based CAPTCHAs</li>
            <li>Custom implementations</li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Contact</h3>
          <ul>
            <li><a href="mailto:support@captchafinder.com">support@captchafinder.com</a></li>
            <li><a href="#">Twitter</a></li>
            <li><a href="#">GitHub</a></li>
            <li><a href="#">Discord</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>Â© 2025 Captcha Finder. All rights reserved. | <a href="#" style="color: #94a3b8;">Privacy Policy</a> | <a href="#" style="color: #94a3b8;">Terms of Service</a></p>
      </div>
    </div>
  </footer>

  <script>
    // === THEME TOGGLE ===
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;
    const icon = themeToggle.querySelector('i');
    const savedTheme = localStorage.getItem('theme') || 'light';
    body.setAttribute('data-theme', savedTheme);
    icon.classList.toggle('fa-sun', savedTheme === 'dark');
    icon.classList.toggle('fa-moon', savedTheme === 'light');

    themeToggle.addEventListener('click', () => {
      const isDark = body.getAttribute('data-theme') === 'dark';
      const newTheme = isDark ? 'light' : 'dark';
      body.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      icon.classList.toggle('fa-sun', !isDark);
      icon.classList.toggle('fa-moon', isDark);
    });

    // === AUTH & USER MENU ===
    const userMenu = document.getElementById('userMenu');
    async function updateUserMenu() {
      const res = await fetch('/api/auth/me');
      const data = await res.json();
      if (data.username) {
        userMenu.innerHTML = `
          <span class="username">${data.username}</span>
          <button class="logout" onclick="logout()">Logout</button>
        `;
      } else {
        userMenu.innerHTML = `
          <a href="/login.html">Login</a>
          <a href="/register.html">Register</a>
        `;
      }
    }
    window.logout = async () => {
      await fetch('/api/auth/logout', { method: 'POST' });
      updateUserMenu();
      location.reload();
    };
    updateUserMenu();

    // === SCAN LOGIC (REAL API) ===
    const urlInput = document.getElementById('urlInput');
    const scanBtn = document.getElementById('scanBtn');
    const clearBtn = document.getElementById('clearBtn');
    const resultsSection = document.getElementById('results');
    const resultsContainer = document.getElementById('resultsContainer');

    scanBtn.addEventListener('click', async () => {
      const url = urlInput.value.trim();
      if (!url || !isValidURL(url)) return alert('Please enter a valid URL (including https://)');

      resultsSection.style.display = 'block';
      resultsContainer.innerHTML = `
        <div class="loading">
          <div class="spinner"></div>
          <p>Scanning <strong>${url}</strong>...</p>
        </div>
      `;

      const res = await fetch('/api/scan', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ url })
      });

      const data = await res.json();
      if (data.error) {
        resultsContainer.innerHTML = `<p style="color:var(--danger);">Error: ${data.error}</p>`;
        return;
      }

      displayResults(url, data.captchas || []);
    });

    urlInput.addEventListener('keypress', e => e.key === 'Enter' && scanBtn.click());
    clearBtn.addEventListener('click', () => {
      resultsSection.style.display = 'none';
      resultsContainer.innerHTML = '';
      urlInput.value = '';
    });

    function isValidURL(str) {
      try { new URL(str); return true; } catch (_) { return false; }
    }

    function displayResults(scannedUrl, captchas) {
      if (!captchas.length) {
        resultsContainer.innerHTML = `
          <div class="no-results">
            <i class="fas fa-search" style="font-size: 3rem; color: #ccc; margin-bottom: 1rem;"></i>
            <h3>No CAPTCHAs Found</h3>
            <p>We couldn't detect any CAPTCHA implementations on <strong>${scannedUrl}</strong>.</p>
          </div>
        `;
        return;
      }

      let html = `
        <div style="margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid var(--border);">
          <h3 style="color:var(--success);"><i class="fas fa-check-circle"></i> ${captchas.length} Found</h3>
          <p>Scanned: <strong>${scannedUrl}</strong></p>
        </div>
      `;

      captchas.forEach(c => {
        const color = c.type.includes('RECAPTCHA') ? '#4285f4' :
                     c.type.includes('HCAPTCHA') ? '#344e86' : '#f39c12';
        html += `
          <div class="result-item">
            <div><strong>${c.type}</strong></div>
            <div class="result-type" style="background:${color}20;color:${color}">${c.confidence}%</div>
          </div>
        `;
      });

      html += `
        <div style="margin-top:2rem;text-align:center;display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;">
          <button class="btn btn-outline" onclick="exportResults('json', '${scannedUrl}', ${JSON.stringify(captchas)})">
            <i class="fas fa-file-code"></i> JSON
          </button>
          <button class="btn btn-outline" onclick="exportResults('csv', '${scannedUrl}', ${JSON.stringify(captchas)})">
            <i class="fas fa-file-csv"></i> CSV
          </button>
          <button class="btn btn-primary" onclick="copyResults(${JSON.stringify(captchas)})">
            <i class="fas fa-copy"></i> Copy
          </button>
        </div>
      `;

      resultsContainer.innerHTML = html;
    }

    window.exportResults = (format, url, captchas) => {
      captchas = JSON.parse(captchas);
      if (format === 'json') {
        const data = JSON.stringify({ url, captchas, timestamp: new Date().toISOString() }, null, 2);
        downloadFile(data, 'captcha-results.json', 'application/json');
      } else {
        let csv = 'Type,Confidence,URL,Timestamp\n';
        captchas.forEach(c => csv += `"${c.type}","${c.confidence}%","${url}","${new Date().toISOString()}"\n`);
        downloadFile(csv, 'captcha-results.csv', 'text/csv');
      }
    };

    window.copyResults = (captchas) => {
      captchas = JSON.parse(captchas);
      const text = captchas.map(c => `${c.type} (${c.confidence}%)`).join('\n');
      navigator.clipboard.writeText(text).then(() => alert('Copied!'));
    };

    function downloadFile(content, name, type) {
      const blob = new Blob([content], { type });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = name;
      a.click();
      URL.revokeObjectURL(a.href);
    }

    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener('click', e => {
        e.preventDefault();
        const target = document.querySelector(a.getAttribute('href'));
        if (target) target.scrollIntoView({ behavior: 'smooth' });
      });
    });

    // Placeholder rotation
    window.addEventListener('load', () => {
      const examples = [
        'https://www.google.com/recaptcha/about/',
        'https://dashboard.hcaptcha.com/signup',
        'https://example-bank.com/login'
      ];
      urlInput.placeholder = `Try: ${examples[0]}`;
      let i = 0;
      setInterval(() => {
        urlInput.placeholder = `Try: ${examples[i % examples.length]}`;
        i++;
      }, 3000);
    });
  </script>
</body>
</html>
